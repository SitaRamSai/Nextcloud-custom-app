const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('whiteboard', '', 'js/App-DnBcA9qY.chunk.mjs'),window.OC.filePath('whiteboard', '', 'js/vendor-DscDELSF.chunk.mjs'),window.OC.filePath('whiteboard', '', 'js/NcLoadingIcon-Bq-DISID.chunk.mjs'),window.OC.filePath('whiteboard', '', 'js/index-BZGs7a1j.chunk.mjs'),window.OC.filePath('whiteboard', '', 'css/NcLoadingIcon-B-FsmOiI.chunk.css'),window.OC.filePath('whiteboard', '', 'css/App-Cf93nWXt.chunk.css')])))=>i.map(i=>d[i]);
/*! third party licenses: js/vendor.LICENSE.txt */
import{r as m,a as _,R as u}from"./vendor-DscDELSF.chunk.mjs";import{l as f,R as k}from"./index-BZGs7a1j.chunk.mjs";const L="modulepreload",P=function(e,n){return new URL(e,n).href},b={},T=function(e,n,t){let i=Promise.resolve();if(n&&n.length>0){const l=document.getElementsByTagName("link"),r=document.querySelector("meta[property=csp-nonce]"),p=r?.nonce||r?.getAttribute("nonce");i=Promise.allSettled(n.map(o=>{if(o=P(o,t),o in b)return;b[o]=!0;const a=o.endsWith(".css"),S=a?'[rel="stylesheet"]':"";if(t)for(let s=l.length-1;s>=0;s--){const c=l[s];if(c.href===o&&(!a||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${S}`))return;const d=document.createElement("link");if(d.rel=a?"stylesheet":L,a||(d.as="script"),d.crossOrigin="",d.href=o,p&&d.setAttribute("nonce",p),document.head.appendChild(d),a)return new Promise((s,c)=>{d.addEventListener("load",s),d.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${o}`)))})}))}function h(l){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=l,window.dispatchEvent(r),!r.defaultPrevented)throw l}return i.then(l=>{for(const r of l||[])r.status==="rejected"&&h(r.reason);return e().catch(h)})};function A(){return f("files_sharing","isPublic",null)??document.querySelector('input#isPublic[type="hidden"][name="isPublic"][value="1"]')!==null}function w(){return f("files_sharing","sharingToken",null)??document.querySelector('input#sharingToken[type="hidden"]')?.value??null}const C=k("whiteboard","dist/"),$=m.lazy(()=>T(()=>import("./App-DnBcA9qY.chunk.mjs"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),E=()=>Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10),g=(e,n)=>{const t=_.createRoot(e);return t.render(u.createElement(m.StrictMode,null,u.createElement(m.Suspense,{fallback:u.createElement("div",null,"Loading...")},u.createElement($,{...n})))),t};window.EXCALIDRAW_ASSET_PATH=C;const q=w();A()&&I(q),R();function I(e){if(document.querySelector(".files-list__table")||document.querySelector("#preview table.files-filestable")){const t=y();v(t);return}const n=f("whiteboard","file_id");document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("preview");if(!t){console.error("#imgframe element not found");return}t.innerHTML="";const i=N();t.appendChild(i),g(i,{fileId:n,isEmbedded:!1,fileName:document.title,publicSharingToken:e})})}function R(){const e=y();typeof OCA.Viewer<"u"?v(e):console.error("Could not register whiteboard handler for viewer")}function N(){const e=document.createElement("div");return e.id=`whiteboard-${E()}`,e.className="whiteboard",e}function y(){return{name:"Whiteboard",render(e){this.$emit("update:loaded",!0);const n=E();return this.$nextTick(()=>{const t=document.getElementById(`whiteboard-${n}`);t.addEventListener("keydown",i=>{i.key==="Escape"&&i.stopPropagation()}),this.root=g(t,{fileId:this.fileid,isEmbedded:this.isEmbedded,fileName:this.basename,publicSharingToken:w()})}),e("div",{attrs:{id:`whiteboard-${n}`},class:["whiteboard",{"whiteboard-viewer__embedding":this.isEmbedded}]},"")},beforeDestroy(){this.root?.unmount()},props:{filename:{type:String,default:null},fileid:{type:Number,default:null},isEmbedded:{type:Boolean,default:!1}},data:()=>({root:null})}}function v(e){window.OCA.Viewer.registerHandler({id:"whiteboard",mimes:["application/vnd.excalidraw+json"],component:e,group:null,theme:"default",canCompare:!0})}export{w as g};
